<!doctype html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Jadwal - ILHAMI Pro</title>

    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/tailwind.css" />

    <style>
      :root {
        --primary: #4F46E5;
        --bg-app: #F8FAFC;
      }
      body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: var(--bg-app); color: #334155; }

      .glass-panel {
        background: #ffffff;
        border: 1px solid #E2E8F0;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
        border-radius: 1rem;
      }

      /* Schedule Card */
      .schedule-card {
        background: white;
        border: 1px solid #E2E8F0;
        border-radius: 1rem;
        padding: 1.25rem;
        transition: all 0.2s;
      }
      .schedule-card:hover {
        border-color: #C7D2FE;
        box-shadow: 0 4px 12px rgba(79, 70, 229, 0.08);
      }
      .schedule-card.privat { border-left: 4px solid #3B82F6; }
      .schedule-card.kelas { border-left: 4px solid #10B981; }

      /* Modal Styling */
      .modal {
        position: fixed;
        inset: 0;
        z-index: 50;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(15, 23, 42, 0.6);
        backdrop-filter: blur(4px);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s;
      }
      .modal.show {
        opacity: 1;
        pointer-events: auto;
      }
      .modal.show .modal-card {
        transform: scale(1) translateY(0);
      }
      .modal-card {
        background: white;
        border-radius: 1.5rem;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        max-width: 600px;
        width: 95%;
        max-height: 90vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        transform: scale(0.95) translateY(10px);
        transition: transform 0.2s;
      }
      .modal-card.detail-modal {
        max-width: 1000px;
      }

      /* Custom Input */
      .custom-input {
        width: 100%;
        padding: 0.625rem 0.875rem;
        border: 1px solid #E2E8F0;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        transition: all 0.2s;
        background: white;
      }
      .custom-input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
      }
      .custom-select {
        width: 100%;
        padding: 0.625rem 0.875rem;
        border: 1px solid #E2E8F0;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        background: white;
        cursor: pointer;
      }
      .custom-select:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
      }

      /* Slot Card */
      .slot-card {
        background: #F8FAFC;
        border: 1px solid #E2E8F0;
        border-radius: 0.75rem;
        padding: 1rem;
        margin-bottom: 0.75rem;
        position: relative;
      }
      .slot-card .slot-remove {
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        width: 1.5rem;
        height: 1.5rem;
        border-radius: 0.375rem;
        background: #FEE2E2;
        color: #EF4444;
        border: none;
        font-size: 0.75rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
      }
      .slot-card .slot-remove:hover {
        background: #FECACA;
      }

      /* Detail Table */
      .detail-table {
        overflow-x: auto;
      }
      .detail-table table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.875rem;
      }
      .detail-table th {
        background: #F8FAFC;
        padding: 0.875rem 1rem;
        text-align: left;
        font-weight: 600;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        color: #64748B;
        border-bottom: 1px solid #E2E8F0;
      }
      .detail-table td {
        padding: 0.875rem 1rem;
        border-bottom: 1px solid #F1F5F9;
        vertical-align: middle;
      }
      .detail-table tr:hover {
        background: #F8FAFC;
      }

      /* Status Pills */
      .status-pill {
        display: inline-flex;
        align-items: center;
        padding: 0.25rem 0.625rem;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 600;
      }
      .status-pill.completed {
        background: #D1FAE5;
        color: #059669;
      }
      .status-pill.pending {
        background: #FEF3C7;
        color: #D97706;
      }
      .status-pill.empty {
        background: #F1F5F9;
        color: #64748B;
      }

      .modern-table { width: 100%; border-collapse: collapse; }
      .modern-table thead th {
        background-color: #f8fafc;
        color: #64748b;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        padding: 1rem 1.25rem;
        font-weight: 700;
        text-align: left;
        border-bottom: 1px solid #e2e8f0;
      }
      .modern-table tbody tr {
        transition: all 0.2s ease;
        border-bottom: 1px solid #f1f5f9;
      }
      .modern-table tbody tr:hover { background-color: #f8fafc; }
      .modern-table td { padding: 1rem 1.25rem; vertical-align: middle; }

      /* Form Error */
      .form-error {
        color: #EF4444;
        font-size: 0.875rem;
        margin-top: 0.5rem;
        padding: 0.5rem;
        background: #FEF2F2;
        border-radius: 0.5rem;
        display: none;
      }
      .form-error:not(:empty) {
        display: block;
      }

      /* Filter Pills */
      .filter-pill {
        padding: 0.5rem 1rem;
        border-radius: 9999px;
        font-size: 0.875rem;
        font-weight: 500;
        border: 1px solid #E2E8F0;
        background: white;
        color: #64748B;
        cursor: pointer;
        transition: all 0.2s;
      }
      .filter-pill:hover {
        border-color: #C7D2FE;
        color: #4F46E5;
      }
      .filter-pill.active {
        background: #4F46E5;
        border-color: #4F46E5;
        color: white;
      }

      /* Edit modal needs higher z-index to appear above detail modal */
      #editModal {
        z-index: 60;
      }

      /* Status Tabs */
      .status-tab {
        color: #64748B;
        background: transparent;
      }
      .status-tab:hover {
        background: #F1F5F9;
      }
      .status-tab.active {
        background: linear-gradient(135deg, #4F46E5 0%, #6366F1 100%);
        color: white;
        box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
      }
      .status-tab.active i {
        color: white !important;
      }

      /* Selesai card styling */
      .schedule-card.selesai {
        opacity: 0.85;
        border-left-color: #10B981 !important;
      }
      .schedule-card.selesai::after {
        content: 'SELESAI';
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        background: #D1FAE5;
        color: #059669;
        font-size: 0.625rem;
        font-weight: 700;
        padding: 0.25rem 0.5rem;
        border-radius: 0.375rem;
        letter-spacing: 0.05em;
      }
    </style>
  </head>

  <body class="app h-screen flex flex-col overflow-hidden" data-page="jadwal">
    <main class="content flex-1 overflow-y-auto p-4 md:p-8">

      <!-- Header -->
      <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-6">
        <div class="flex items-center gap-4">
          <button class="p-2 rounded-lg hover:bg-white shadow-sm md:hidden text-gray-600 transition" id="sidebarToggle">
            <i class="fa-solid fa-bars"></i>
          </button>
          <div>
            <h1 class="text-3xl font-bold text-gray-800 tracking-tight flex items-center gap-3">
              <span class="bg-gradient-to-br from-indigo-500 to-blue-600 text-white p-2.5 rounded-xl text-xl shadow-lg shadow-indigo-200">
                <i class="fa-solid fa-calendar-days"></i>
              </span>
              Manajemen Jadwal
            </h1>
            <p class="text-gray-500 mt-1 text-sm font-medium ml-1">Kelola jadwal les siswa secara terstruktur.</p>
          </div>
        </div>
        <button class="bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2.5 rounded-xl shadow-lg shadow-indigo-200 transition flex items-center gap-2 font-semibold text-sm transform active:scale-95" id="openJadwalModal">
          <i class="fa-solid fa-plus"></i> Tambah Jadwal
        </button>
      </header>

      <!-- Status Tabs -->
      <div class="mb-6 bg-white rounded-2xl p-1 shadow-sm border border-gray-100 inline-flex">
        <button class="status-tab active px-6 py-2.5 rounded-xl text-sm font-semibold transition-all" data-status="aktif">
          <i class="fa-solid fa-clock text-indigo-500 mr-2"></i>Jadwal Aktif
        </button>
        <button class="status-tab px-6 py-2.5 rounded-xl text-sm font-semibold transition-all" data-status="selesai">
          <i class="fa-solid fa-check-circle text-emerald-500 mr-2"></i>Jadwal Selesai
        </button>
      </div>

      <!-- Filters -->
      <div class="mb-6 flex flex-wrap items-center gap-3">
        <span class="text-sm font-medium text-gray-500">Filter:</span>
        <button class="filter-pill active" data-filter="all">Semua</button>
        <button class="filter-pill" data-filter="privat">
          <i class="fa-solid fa-user text-blue-500 mr-1"></i> Privat
        </button>
        <button class="filter-pill" data-filter="kelas">
          <i class="fa-solid fa-users text-emerald-500 mr-1"></i> Kelas
        </button>
      </div>

      <!-- Jadwal List -->
      <section class="glass-panel overflow-hidden">
        <div class="p-5 border-b border-gray-100 bg-gradient-to-r from-indigo-50 to-blue-50">
          <h3 class="font-bold text-gray-800 text-lg flex items-center gap-2">
            <i class="fa-solid fa-list-check text-indigo-500"></i>
            Daftar Jadwal
          </h3>
          <p class="text-gray-500 text-xs mt-0.5">Jadwal les privat dan kelas</p>
        </div>
        <div class="overflow-x-auto">
          <table class="modern-table">
            <thead>
              <tr>
                <th>Nama</th>
                <th>Program</th>
                <th>Tipe</th>
                <th>Pertemuan</th>
                <th>Status</th>
                <th class="text-right">Aksi</th>
              </tr>
            </thead>
            <tbody id="jadwalList"></tbody>
          </table>
        </div>
        <div id="jadwalEmpty" class="hidden flex-col items-center justify-center py-16 text-center">
          <div class="bg-indigo-50 p-4 rounded-full mb-3">
            <i class="fa-solid fa-calendar-xmark text-3xl text-indigo-300"></i>
          </div>
          <p class="text-gray-500 font-medium">Belum ada jadwal.</p>
          <p class="text-gray-400 text-sm mt-1">Klik tombol "Tambah Jadwal" untuk memulai.</p>
        </div>
      </section>
    </main>

    <!-- Modal Tambah Jadwal -->
    <div id="jadwalModal" class="modal hidden">
      <div class="modal-card">
        <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gradient-to-r from-indigo-500 to-blue-600">
          <div class="text-white">
            <h3 class="text-lg font-bold flex items-center gap-2">
              <i class="fa-solid fa-calendar-plus"></i> Tambah Jadwal
            </h3>
            <p class="text-indigo-100 text-xs mt-0.5">Pilih siswa dan atur jadwal pertemuan.</p>
          </div>
          <button id="closeJadwalModal" class="text-white/80 hover:text-white hover:bg-white/20 w-8 h-8 rounded-lg flex items-center justify-center transition">
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>
        <form id="jadwalForm" class="p-6 overflow-y-auto max-h-[60vh] space-y-4">
          <!-- Tipe Jadwal Selection -->
          <div>
            <label class="block text-gray-700 font-semibold mb-2 text-sm">
              <i class="fa-solid fa-layer-group text-indigo-500 mr-1"></i> Tipe Jadwal
            </label>
            <div class="grid grid-cols-2 gap-3">
              <label class="relative cursor-pointer">
                <input type="radio" name="tipeJadwal" value="privat" class="peer sr-only" checked />
                <div class="p-4 border-2 border-gray-200 rounded-xl text-center peer-checked:border-blue-500 peer-checked:bg-blue-50 transition">
                  <i class="fa-solid fa-user text-2xl text-blue-500 mb-2"></i>
                  <div class="font-semibold text-gray-700">Privat</div>
                  <div class="text-xs text-gray-500">Les 1-on-1</div>
                </div>
              </label>
              <label class="relative cursor-pointer">
                <input type="radio" name="tipeJadwal" value="kelas" class="peer sr-only" />
                <div class="p-4 border-2 border-gray-200 rounded-xl text-center peer-checked:border-emerald-500 peer-checked:bg-emerald-50 transition">
                  <i class="fa-solid fa-users text-2xl text-emerald-500 mb-2"></i>
                  <div class="font-semibold text-gray-700">Kelas</div>
                  <div class="text-xs text-gray-500">Les Kelompok</div>
                </div>
              </label>
            </div>
          </div>

          <!-- Privat Section -->
          <div id="privatSection">
            <div class="mb-4">
              <label class="block text-gray-700 font-semibold mb-1.5 text-sm">
                <i class="fa-solid fa-user-graduate text-blue-500 mr-1"></i> Pilih Siswa
              </label>
              <select id="jadwalSiswa" class="custom-select"></select>
            </div>

            <div id="programInfo" class="bg-indigo-50 border border-indigo-100 rounded-xl p-4 mb-4">
              <div class="grid grid-cols-2 gap-4 text-sm">
                <div>
                  <div class="text-xs font-semibold text-indigo-600 uppercase tracking-wider mb-1">Program</div>
                  <div id="programText" class="text-gray-800 font-medium">-</div>
                </div>
                <div>
                  <div class="text-xs font-semibold text-indigo-600 uppercase tracking-wider mb-1">Jenjang</div>
                  <div id="jenjangText" class="text-gray-800 font-medium">-</div>
                </div>
                <div>
                  <div class="text-xs font-semibold text-indigo-600 uppercase tracking-wider mb-1">Tarif Gaji</div>
                  <div id="tarifText" class="text-gray-800 font-medium">-</div>
                </div>
                <div>
                  <div class="text-xs font-semibold text-indigo-600 uppercase tracking-wider mb-1">Jumlah Pertemuan</div>
                  <div id="pertemuanText" class="text-gray-800 font-medium">-</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Kelas Section -->
          <div id="kelasSection" class="hidden">
            <div class="mb-4">
              <label class="block text-gray-700 font-semibold mb-1.5 text-sm">
                <i class="fa-solid fa-layer-group text-emerald-500 mr-1"></i> Pilih Kelas
              </label>
              <select id="jadwalKelas" class="custom-select"></select>
            </div>

            <div id="kelasCreateSection" class="hidden space-y-4 mb-4">
              <div>
                <label class="block text-gray-700 font-semibold mb-1.5 text-sm">Nama Kelas Baru</label>
                <input id="kelasNamaBaru" type="text" placeholder="Contoh: Kelas Matematika SMA" class="custom-input" />
              </div>
              <div class="bg-emerald-50 border border-emerald-100 rounded-xl p-4">
                <div class="text-xs font-semibold text-emerald-600 uppercase tracking-wider mb-2">Program Dalam Kelas</div>
                <div id="kelasProgramChecklist" class="grid grid-cols-2 gap-2 text-sm"></div>
              </div>
            </div>

            <div id="kelasInfoSection" class="bg-emerald-50 border border-emerald-100 rounded-xl p-4 mb-4 hidden">
              <div class="text-xs font-semibold text-emerald-600 uppercase tracking-wider mb-1">Program Dalam Kelas</div>
              <div id="kelasProgramList" class="text-gray-800 font-medium text-sm">-</div>
            </div>

            <div class="mb-4">
              <label class="block text-gray-700 font-semibold mb-1.5 text-sm">
                <i class="fa-solid fa-chalkboard-user text-emerald-500 mr-1"></i> Edukator
              </label>
              <select id="kelasEdukator" class="custom-select"></select>
            </div>

            <div class="grid grid-cols-2 gap-4 mb-4">
              <div>
                <label class="block text-gray-700 font-semibold mb-1.5 text-sm">Tanggal Mulai</label>
                <input id="kelasTanggalMulai" type="date" class="custom-input" />
              </div>
              <div>
                <label class="block text-gray-700 font-semibold mb-1.5 text-sm">Tanggal Berakhir</label>
                <input id="kelasTanggalAkhir" type="date" class="custom-input" />
              </div>
            </div>

            <div class="bg-gray-50 border border-gray-200 rounded-xl p-4 mb-4">
              <div class="text-xs font-semibold text-gray-600 uppercase tracking-wider mb-2">
                <i class="fa-solid fa-users mr-1"></i> Siswa Terdaftar
              </div>
              <div id="kelasSiswaList" class="text-gray-700 text-sm">Pilih kelas terlebih dahulu.</div>
            </div>
          </div>

          <!-- Slots Section -->
          <div>
            <label class="block text-gray-700 font-semibold mb-2 text-sm">
              <i class="fa-solid fa-clock text-indigo-500 mr-1"></i> Jadwal Pertemuan
            </label>
            <div id="jadwalSlots" class="space-y-3"></div>
            <button type="button" id="addSlotBtn" class="hidden mt-3 w-full py-2.5 border-2 border-dashed border-indigo-300 text-indigo-600 rounded-xl hover:bg-indigo-50 transition font-semibold text-sm">
              <i class="fa-solid fa-plus mr-1"></i> Tambah Hari
            </button>
          </div>

          <div id="jadwalError" class="form-error"></div>

          <div class="flex justify-end gap-3 pt-4 border-t border-gray-100">
            <button type="button" id="cancelJadwalModal" class="px-5 py-2.5 text-gray-600 hover:bg-gray-100 rounded-xl transition font-medium text-sm">
              Batal
            </button>
            <button type="submit" class="px-6 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl shadow-lg shadow-indigo-200 transition font-semibold text-sm">
              <i class="fa-solid fa-check mr-1"></i> Simpan Jadwal
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal Edit Jadwal -->
    <div id="editModal" class="modal hidden">
      <div class="modal-card" style="max-width: 500px;">
        <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gradient-to-r from-amber-500 to-orange-500">
          <div class="text-white">
            <h3 class="text-lg font-bold flex items-center gap-2">
              <i class="fa-solid fa-pen-to-square"></i> Edit Jadwal
            </h3>
            <p class="text-amber-100 text-xs mt-0.5">Perbarui tanggal dan jam jadwal.</p>
          </div>
          <button id="closeEditModal" class="text-white/80 hover:text-white hover:bg-white/20 w-8 h-8 rounded-lg flex items-center justify-center transition">
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>
        <form id="editForm" class="p-6 space-y-4">
          <input type="hidden" id="editJadwalId" />

          <div>
            <label class="block text-gray-700 font-semibold mb-1.5 text-sm">Tanggal</label>
            <input id="editTanggal" type="date" required class="custom-input" />
          </div>

          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="block text-gray-700 font-semibold mb-1.5 text-sm">Jam Mulai (24 jam)</label>
              <input id="editMulai" type="text" class="custom-input" placeholder="HH:MM" pattern="[0-2][0-9]:[0-5][0-9]" maxlength="5" inputmode="numeric" />
            </div>
            <div>
              <label class="block text-gray-700 font-semibold mb-1.5 text-sm">Jam Selesai (24 jam)</label>
              <input id="editSelesai" type="text" class="custom-input" placeholder="HH:MM" pattern="[0-2][0-9]:[0-5][0-9]" maxlength="5" inputmode="numeric" />
            </div>
          </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-1.5 text-sm">Edukator</label>
            <select id="editEdukator" required class="custom-select"></select>
          </div>

          <div>
            <label class="block text-gray-700 font-semibold mb-1.5 text-sm">Mapel</label>
            <select id="editMapel" required class="custom-select"></select>
          </div>

          <div id="editError" class="form-error"></div>

          <div class="flex justify-end gap-3 pt-4 border-t border-gray-100">
            <button type="button" id="cancelEditModal" class="px-5 py-2.5 text-gray-600 hover:bg-gray-100 rounded-xl transition font-medium text-sm">
              Batal
            </button>
            <button type="submit" class="px-6 py-2.5 bg-amber-600 hover:bg-amber-700 text-white rounded-xl shadow-lg shadow-amber-200 transition font-semibold text-sm">
              <i class="fa-solid fa-check mr-1"></i> Simpan
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal Detail Jadwal -->
    <div id="detailModal" class="modal hidden">
      <div class="modal-card detail-modal">
        <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gradient-to-r from-indigo-500 to-purple-600">
          <div class="text-white">
            <h3 class="text-lg font-bold flex items-center gap-2">
              <i class="fa-solid fa-list-check"></i> Detail Jadwal
            </h3>
            <p id="detailSubtitle" class="text-indigo-100 text-sm mt-0.5">-</p>
          </div>
          <button id="closeDetailModal" class="text-white/80 hover:text-white hover:bg-white/20 w-8 h-8 rounded-lg flex items-center justify-center transition">
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>
        <div class="detail-table overflow-y-auto max-h-[60vh]">
          <table>
            <thead>
              <tr>
                <th>Pertemuan</th>
                <th>Hari</th>
                <th>Tanggal</th>
                <th>Jam</th>
                <th>Edukator</th>
                <th>Mapel</th>
                <th>Materi</th>
                <th>Status</th>
                <th class="text-center">Aksi</th>
              </tr>
            </thead>
            <tbody id="detailRows"></tbody>
          </table>
        </div>
        <div class="px-6 py-4 border-t border-gray-100 flex justify-end">
          <button type="button" id="closeDetailFooter" class="px-5 py-2.5 text-gray-600 hover:bg-gray-100 rounded-xl transition font-medium text-sm">
            Tutup
          </button>
        </div>
      </div>
    </div>

    <script src="/js/sidebar.js"></script>
    <script src="/js/jadwal.js"></script>
  </body>
</html>
